INFO:     Will watch for changes in these directories: ['/home/evan/dev/chatbot_skeleton']
INFO:     Uvicorn running on http://0.0.0.0:8002 (Press CTRL+C to quit)
INFO:     Started reloader process [605896] using WatchFiles
INFO:     Started server process [605930]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
            🔵 Incoming Request             
┌─────────────────┬────────────────────────┐
│ Method          │ GET                    │
│ URL             │ http://localhost:8002/ │
│ Path            │ /                      │
│ Header host     │ localhost:8002         │
│ Header          │ curl/7.81.0            │
│ user-agent      │                        │
│ Header accept   │ */*                    │
└─────────────────┴────────────────────────┘

                 🟢 Response                  
┌─────────────────┬──────────────────────────┐
│ Status          │ 200                      │
│ Time            │ 0.006s                   │
│ Header          │ 3220                     │
│ content-length  │                          │
│ Header          │ text/html; charset=utf-8 │
│ content-type    │                          │
└─────────────────┴──────────────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:38264 - "GET / HTTP/1.1" 200 OK
              🔵 Incoming Request               
┌─────────────────┬────────────────────────────┐
│ Method          │ GET                        │
│ URL             │ http://localhost:8002/docs │
│ Path            │ /docs                      │
│ Header host     │ localhost:8002             │
│ Header          │ curl/7.81.0                │
│ user-agent      │                            │
│ Header accept   │ */*                        │
└─────────────────┴────────────────────────────┘

                 🟢 Response                  
┌─────────────────┬──────────────────────────┐
│ Status          │ 200                      │
│ Time            │ 0.002s                   │
│ Header          │ 948                      │
│ content-length  │                          │
│ Header          │ text/html; charset=utf-8 │
│ content-type    │                          │
└─────────────────┴──────────────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:42264 - "GET /docs HTTP/1.1" 200 OK
                  🔵 Incoming Request                   
┌─────────────────┬────────────────────────────────────┐
│ Method          │ POST                               │
│ URL             │ http://localhost:8002/api/threads/ │
│ Path            │ /api/threads/                      │
│ Header host     │ localhost:8002                     │
│ Header          │ curl/7.81.0                        │
│ user-agent      │                                    │
│ Header accept   │ */*                                │
│ Header          │ application/json                   │
│ content-type    │                                    │
└─────────────────┴────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {                                                                            │
│   "user_id": "123e4567-e89b-12d3-a456-426614174000",                         │
│   "title": "Test Chat Thread"                                                │
│ }                                                                            │
╰──────────────────────────────────────────────────────────────────────────────╯

Transaction rolled back due to ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "chat_thread" does not exist
[SQL: INSERT INTO chat_thread (thread_id, user_id, created_at, updated_at, status, title) VALUES ($1::UUID, $2::UUID, now(), now(), $3::VARCHAR, $4::VARCHAR)]
[parameters: (UUID('ea225997-f779-412e-9586-c9bf23fb633c'), UUID('123e4567-e89b-12d3-a456-426614174000'), 'active', 'Test Chat Thread')]
(Background on this error at: https://sqlalche.me/e/20/f405)
             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 500              │
│ Time            │ 0.042s           │
│ Header          │ 520              │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:54410 - "POST /api/threads/ HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in '.venv/lib/python3.13/site-packages/psycopg2/sql.py', '.venv/lib/python3.13/site-packages/psycopg2/errors.py', '.venv/lib/python3.13/site-packages/psycopg2/pool.py', '.venv/lib/python3.13/site-packages/psycopg2/extras.py', '.venv/lib/python3.13/site-packages/psycopg2/_json.py', '.venv/lib/python3.13/site-packages/psycopg2/tz.py', '.venv/lib/python3.13/site-packages/psycopg2/errorcodes.py', '.venv/lib/python3.13/site-packages/psycopg2/extensions.py', '.venv/lib/python3.13/site-packages/psycopg2/_range.py', '.venv/lib/python3.13/site-packages/psycopg2/_ipaddress.py', '.venv/lib/python3.13/site-packages/psycopg2/__init__.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [605930]
INFO:     Started server process [606651]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
                  🔵 Incoming Request                   
┌─────────────────┬────────────────────────────────────┐
│ Method          │ POST                               │
│ URL             │ http://localhost:8002/api/threads/ │
│ Path            │ /api/threads/                      │
│ Header host     │ localhost:8002                     │
│ Header          │ curl/7.81.0                        │
│ user-agent      │                                    │
│ Header accept   │ */*                                │
│ Header          │ application/json                   │
│ content-type    │                                    │
└─────────────────┴────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {                                                                            │
│   "user_id": "123e4567-e89b-12d3-a456-426614174000",                         │
│   "title": "Test Chat Thread"                                                │
│ }                                                                            │
╰──────────────────────────────────────────────────────────────────────────────╯

             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 200              │
│ Time            │ 0.060s           │
│ Header          │ 211              │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:50528 - "POST /api/threads/ HTTP/1.1" 200 OK
                              🔵 Incoming Request                               
┌─────────────────┬────────────────────────────────────────────────────────────┐
│ Method          │ POST                                                       │
│ URL             │ http://localhost:8002/api/threads/e45c18f9-5f57-451d-a2dd… │
│ Path            │ /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages │
│ Query           │ {'user_id': '123e4567-e89b-12d3-a456-426614174000'}        │
│ Header host     │ localhost:8002                                             │
│ Header          │ curl/7.81.0                                                │
│ user-agent      │                                                            │
│ Header accept   │ */*                                                        │
│ Header          │ application/json                                           │
│ content-type    │                                                            │
└─────────────────┴────────────────────────────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {"content": "Hello\! Can you calculate 25 * 18 for me?", "message_type":     │
│ "text"}                                                                      │
╰──────────────────────────────────────────────────────────────────────────────╯

             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 422              │
│ Time            │ 0.003s           │
│ Header          │ 126              │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:39502 - "POST /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages?user_id=123e4567-e89b-12d3-a456-426614174000 HTTP/1.1" 422 Unprocessable Content
                              🔵 Incoming Request                               
┌─────────────────┬────────────────────────────────────────────────────────────┐
│ Method          │ POST                                                       │
│ URL             │ http://localhost:8002/api/threads/e45c18f9-5f57-451d-a2dd… │
│ Path            │ /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages │
│ Query           │ {'user_id': '123e4567-e89b-12d3-a456-426614174000'}        │
│ Header host     │ localhost:8002                                             │
│ Header          │ curl/7.81.0                                                │
│ user-agent      │                                                            │
│ Header accept   │ */*                                                        │
│ Header          │ application/json                                           │
│ content-type    │                                                            │
└─────────────────┴────────────────────────────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {"content": "Hello\! Can you calculate 25 * 18 for me?", "message_type":     │
│ "text"}                                                                      │
╰──────────────────────────────────────────────────────────────────────────────╯

             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 422              │
│ Time            │ 0.004s           │
│ Header          │ 126              │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:46136 - "POST /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages?user_id=123e4567-e89b-12d3-a456-426614174000 HTTP/1.1" 422 Unprocessable Content
                              🔵 Incoming Request                               
┌─────────────────┬────────────────────────────────────────────────────────────┐
│ Method          │ POST                                                       │
│ URL             │ http://localhost:8002/api/threads/e45c18f9-5f57-451d-a2dd… │
│ Path            │ /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages │
│ Query           │ {'user_id': '123e4567-e89b-12d3-a456-426614174000'}        │
│ Header host     │ localhost:8002                                             │
│ Header          │ curl/7.81.0                                                │
│ user-agent      │                                                            │
│ Header accept   │ */*                                                        │
│ Header          │ application/json                                           │
│ content-type    │                                                            │
└─────────────────┴────────────────────────────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {                                                                            │
│   "content": "Hello. Can you calculate 25 * 18 for me?",                     │
│   "message_type": "text"                                                     │
│ }                                                                            │
╰──────────────────────────────────────────────────────────────────────────────╯

Transaction rolled back due to AttributeError: Could not locate column in row for column 'metadata_json'
             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 500              │
│ Time            │ 0.011s           │
│ Header          │ 70               │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:38138 - "POST /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages?user_id=123e4567-e89b-12d3-a456-426614174000 HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'alembic/versions/b6a81be961a6_update_metadata_columns.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [606651]
INFO:     Started server process [607745]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
                              🔵 Incoming Request                               
┌─────────────────┬────────────────────────────────────────────────────────────┐
│ Method          │ POST                                                       │
│ URL             │ http://localhost:8002/api/threads/e45c18f9-5f57-451d-a2dd… │
│ Path            │ /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages │
│ Query           │ {'user_id': '123e4567-e89b-12d3-a456-426614174000'}        │
│ Header host     │ localhost:8002                                             │
│ Header          │ curl/7.81.0                                                │
│ user-agent      │                                                            │
│ Header accept   │ */*                                                        │
│ Header          │ application/json                                           │
│ content-type    │                                                            │
└─────────────────┴────────────────────────────────────────────────────────────┘
╭────────────────────────────── 📝 Request Body ───────────────────────────────╮
│ {                                                                            │
│   "content": "Hello. Can you calculate 25 * 18 for me?",                     │
│   "message_type": "text"                                                     │
│ }                                                                            │
╰──────────────────────────────────────────────────────────────────────────────╯

Transaction rolled back due to AttributeError: Could not locate column in row for column 'metadata_json'
             🟢 Response              
┌─────────────────┬──────────────────┐
│ Status          │ 500              │
│ Time            │ 0.051s           │
│ Header          │ 70               │
│ content-length  │                  │
│ Header          │ application/json │
│ content-type    │                  │
└─────────────────┴──────────────────┘
────────────────────────────────────────────────────────────────────────────────

INFO:     127.0.0.1:52664 - "POST /api/threads/e45c18f9-5f57-451d-a2dd-7be4501aa2f2/messages?user_id=123e4567-e89b-12d3-a456-426614174000 HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'src/infrastructure/config/ports.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [607745]
INFO:     Started server process [610460]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [610460]
INFO:     Started server process [610838]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/infrastructure/config/database.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [610838]
INFO:     Started server process [611835]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/infrastructure/config/database.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [611835]
INFO:     Started server process [611914]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [611914]
INFO:     Started server process [612240]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [612240]
INFO:     Started server process [612477]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [612477]
INFO:     Started server process [612539]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [612539]
INFO:     Started server process [612681]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [612681]
INFO:     Started server process [613041]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [613041]
INFO:     Started server process [613100]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/cli.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [613100]
INFO:     Started server process [613209]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'seed_database.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [613209]
INFO:     Started server process [615082]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/conftest.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [615082]
INFO:     Started server process [615204]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_integration.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [615204]
INFO:     Started server process [615495]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'profile_app.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [615495]
INFO:     Started server process [615698]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [615698]
INFO:     Started server process [616173]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/infrastructure/profiling/profiler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [616173]
INFO:     Started server process [616309]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/infrastructure/profiling/profiler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [616309]
INFO:     Started server process [616591]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/infrastructure/config/ports.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [616591]
INFO:     Started server process [618485]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
